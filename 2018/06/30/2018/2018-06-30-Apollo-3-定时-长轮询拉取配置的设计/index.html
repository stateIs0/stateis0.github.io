<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Apollo-3-定时-长轮询拉取配置的设计 | 莫那·鲁道的技术博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="article">
<meta property="og:title" content="Apollo-3-定时-长轮询拉取配置的设计">
<meta property="og:url" content="http://thinkinjava.cn/2018/06/30/2018/2018-06-30-Apollo-3-%E5%AE%9A%E6%97%B6-%E9%95%BF%E8%BD%AE%E8%AF%A2%E6%8B%89%E5%8F%96%E9%85%8D%E7%BD%AE%E7%9A%84%E8%AE%BE%E8%AE%A1/index.html">
<meta property="og:site_name" content="莫那·鲁道的技术博客">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/4236553-fd8d97b7ee24aaa0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="article:published_time" content="2018-06-29T18:11:11.000Z">
<meta property="article:modified_time" content="2021-11-25T07:28:04.323Z">
<meta property="article:author" content="莫那·鲁道">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/4236553-fd8d97b7ee24aaa0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  
    <link rel="alternate" href="/atom.xml" title="莫那·鲁道的技术博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">莫那·鲁道的技术博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">莫那·鲁道</a>
        
          <a class="main-nav-link" href="/archives">文章归档</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://thinkinjava.cn"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2018/2018-06-30-Apollo-3-定时-长轮询拉取配置的设计" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/30/2018/2018-06-30-Apollo-3-%E5%AE%9A%E6%97%B6-%E9%95%BF%E8%BD%AE%E8%AF%A2%E6%8B%89%E5%8F%96%E9%85%8D%E7%BD%AE%E7%9A%84%E8%AE%BE%E8%AE%A1/" class="article-date">
  <time datetime="2018-06-29T18:11:11.000Z" itemprop="datePublished">2018-06-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Apollo/">Apollo</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Apollo-3-定时-长轮询拉取配置的设计
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <meta name="referrer" content="no-referrer" />
<span id="more"></span>       ![Apollo 基础模型](https://upload-images.jianshu.io/upload_images/4236553-b852957c3897832b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>如上图所示，Apollo portal 更新配置后，进行轮询的客户端获取更新通知，然后再调用接口获取最新配置。不仅仅只有轮询，还有定时更新（默认 5 分钟一次）。目的就是让客户端能够稳定的获取到最新的配置。</p>
<p>一起来看看他的设计。</p>
<h2 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h2><p>具体的类是 <code>RemoteConfigRepository</code>，每一个 Config —— 也就是 namespace 都有一个 RemoteConfigRepository 对象，表示这个 Config 的远程配置仓库，可以利用这个仓库请求远程服务，得到配置。</p>
<p>RemoteConfigRepository 的构造方法需要一个 <code>namespace</code> 字符串，表明这个 Repository 所属的 Config 名称。</p>
<p>下面是该类的构造方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">RemoteConfigRepository</span><span class="params">(String namespace)</span> </span>&#123;</span><br><span class="line">    m_namespace = namespace;<span class="comment">// Config 名称</span></span><br><span class="line">    m_configCache = <span class="keyword">new</span> AtomicReference&lt;&gt;(); <span class="comment">//  Config 引用</span></span><br><span class="line">    m_configUtil = ApolloInjector.getInstance(ConfigUtil.class);<span class="comment">// 单例的 config 配置,存放 application.properties</span></span><br><span class="line">    m_httpUtil = ApolloInjector.getInstance(HttpUtil.class);<span class="comment">// HTTP 工具</span></span><br><span class="line">    m_serviceLocator = ApolloInjector.getInstance(ConfigServiceLocator.class);<span class="comment">// 远程服务 URL 更新类</span></span><br><span class="line">    remoteConfigLongPollService = ApolloInjector.getInstance(RemoteConfigLongPollService.class);<span class="comment">// 长轮询服务</span></span><br><span class="line">    m_longPollServiceDto = <span class="keyword">new</span> AtomicReference&lt;&gt;();<span class="comment">// 长轮询发现的当前配置发生变化的服务</span></span><br><span class="line">    m_remoteMessages = <span class="keyword">new</span> AtomicReference&lt;&gt;();</span><br><span class="line">    m_loadConfigRateLimiter = RateLimiter.create(m_configUtil.getLoadConfigQPS());<span class="comment">// 限流器</span></span><br><span class="line">    m_configNeedForceRefresh = <span class="keyword">new</span> AtomicBoolean(<span class="keyword">true</span>);<span class="comment">// 是否强制刷新</span></span><br><span class="line">    m_loadConfigFailSchedulePolicy = <span class="keyword">new</span> ExponentialSchedulePolicy(m_configUtil.getOnErrorRetryInterval(),<span class="comment">//1</span></span><br><span class="line">        m_configUtil.getOnErrorRetryInterval() * <span class="number">8</span>);<span class="comment">// 1 * 8;失败定时重试策略: 最小一秒,最大 8 秒.</span></span><br><span class="line">    gson = <span class="keyword">new</span> Gson();<span class="comment">// json 序列化</span></span><br><span class="line">    <span class="keyword">this</span>.trySync(); <span class="comment">// 第一次同步</span></span><br><span class="line">    <span class="keyword">this</span>.schedulePeriodicRefresh();<span class="comment">// 定时刷新</span></span><br><span class="line">    <span class="keyword">this</span>.scheduleLongPollingRefresh();<span class="comment">// 长轮询刷新</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，在构造方法中，就执行了 3 个本地方法，其中就包括定时刷新和长轮询刷新。这两个功能在 apollo 的 github 文档中也有介绍：</p>
<blockquote>
<p>1.客户端和服务端保持了一个长连接，从而能第一时间获得配置更新的推送。<br>   2.客户端还会定时从Apollo配置中心服务端拉取应用的最新配置。<br>  3.这是一个fallback机制，为了防止推送机制失效导致配置不更新。<br>  4.客户端定时拉取会上报本地版本，所以一般情况下，对于定时拉取的操作，服务端都会返回304 - Not Modified。<br>  5.定时频率默认为每5分钟拉取一次，客户端也可以通过在运行时指定System Property: apollo.refreshInterval来覆盖，单位为分钟。</p>
</blockquote>
<p>所以，长连接是更新配置的主要手段，然后用定时任务辅助长连接，防止长连接失败。</p>
<p>那就看看长连接和定时任务的具体代码。</p>
<h2 id="定时任务"><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h2><p>定时任务主要由一个单 core 的线程池维护这定时任务。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="comment">// 定时任务,单个 core. 后台线程</span></span><br><span class="line">    m_executorService = Executors.newScheduledThreadPool(<span class="number">1</span>,</span><br><span class="line">        ApolloThreadFactory.create(<span class="string">&quot;RemoteConfigRepository&quot;</span>, <span class="keyword">true</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">schedulePeriodicRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 默认 5 分钟同步一次.</span></span><br><span class="line">    m_executorService.scheduleAtFixedRate(</span><br><span class="line">        <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">          <span class="meta">@Override</span></span><br><span class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            trySync();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, m_configUtil.getRefreshInterval(), m_configUtil.getRefreshInterval(),<span class="comment">// 5</span></span><br><span class="line">        m_configUtil.getRefreshIntervalTimeUnit());<span class="comment">//单位：分钟</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>具体就是每 5 分钟执行 sync 方法。我简化了一下 sync 方法，一起看看：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sync</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  ApolloConfig previous = m_configCache.get();</span><br><span class="line">  <span class="comment">// 加载远程配置</span></span><br><span class="line">  ApolloConfig current = loadApolloConfig();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//reference equals means HTTP 304</span></span><br><span class="line">  <span class="keyword">if</span> (previous != current) &#123;</span><br><span class="line">    m_configCache.set(current);</span><br><span class="line">    <span class="comment">// 触发监听器</span></span><br><span class="line">    <span class="keyword">this</span>.fireRepositoryChange(m_namespace, <span class="keyword">this</span>.getConfig());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先，拿到上一个 config 对象的引用，然后，加载远程配置，判断是否相等，如果不相等，更新引用缓存，触发监听器。</p>
<p>可以看出，关键是加载远程配置和触发监听器，这两个操作。</p>
<p>loadApolloConfig 方法主要逻辑就是通过 HTTP 请求从 configService 服务里获取到配置。大概步骤如下：</p>
<ol>
<li>首先限流。获取服务列表。然后根据是否有更新通知，决定此次重试几次，如果有更新，重试2次，反之一次。</li>
<li>优先请求通知自己的 configService，如果失败了，就要进行休息，休息策略要看是否得到更新通知了，如果是，就休息一秒，否则按照 SchedulePolicy 策略来。</li>
<li>拿到数据后，重置强制刷新状态和失败休息状态，返回配置。</li>
</ol>
<p><strong>触发监听器步骤：</strong></p>
<ol>
<li>循环远程仓库的监听器，调用他们的 onRepositoryChange 方法。其实就是 Config。</li>
<li>然后，更新 Config 内部的引用，循环向线程池提交任务—— 执行 Config 监听器的 onChange 方法。</li>
</ol>
<p>好，到这里，定时任务就算处理完了，总之就是调用 sync 方法，请求远程  configServer 服务，得到结果后，更新 Config 对象里的配置，并通知监听器。</p>
<p>再来说说长轮询。</p>
<h2 id="长连接-长轮询"><a href="#长连接-长轮询" class="headerlink" title="长连接 / 长轮询"></a>长连接 / 长轮询</h2><p>长轮询实际上就是在一个类似死循环里，不停请求 ConfigServer 的配置变化通知接口 notifications/v2，如果配置有变更，就会返回变更信息，然后向定时任务线程池提交一个任务，任务内容是执行 sync 方法。</p>
<p>在请求 ConfigServer 的时候，ConfigServer 使用了 Servlet 3 的异步特性，将 hold 住连接 30 秒，等到有通知就立刻返回，这样能够实现一个基于 HTTP 的长连接。</p>
<p>关于为什么使用 HTTP 长连接，初次接触 Apollo 的人都会疑惑，为什么使用这种方式，而不是”那种”方式？</p>
<p>下面是作者宋顺的回复：<br><img src="https://upload-images.jianshu.io/upload_images/4236553-fd8d97b7ee24aaa0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>总结一下：</p>
<ol>
<li>为什么不使用消息系统？太复杂，杀鸡用牛刀。</li>
<li>为什么不用  TCP 长连接？对网络环境要求高，容易推送失败。且有双写问题。</li>
<li>为什么使用 HTTP 长轮询？性能足够，结合 Servlet3 的异步特性，能够维持万级连接（一个客户端只有一个长连接）。直接使用 Servlet 的 HTTP 协议，比单独用 TCP 连接方便。HTTP 请求/响应模式，保证了不会出现双写的情况。<strong>最主要还是简单，性能暂时不是瓶颈</strong>。</li>
</ol>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文没有贴很多的代码。因为不是一篇源码分析的文章。</p>
<p>总之，Apollo 的更新配置设计就是通过定时轮询和长轮询进行组合而来。</p>
<p>定时轮询负责调用获取配置接口，长轮询负责调用配置更新通知接口，长轮询得到结果后，将提交一个任务到定时轮询线程池里，执行同步操作——也就是调用获取配置接口。</p>
<p>为什么使用 HTTP 长轮询？ 简单！简单！简单！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://thinkinjava.cn/2018/06/30/2018/2018-06-30-Apollo-3-%E5%AE%9A%E6%97%B6-%E9%95%BF%E8%BD%AE%E8%AF%A2%E6%8B%89%E5%8F%96%E9%85%8D%E7%BD%AE%E7%9A%84%E8%AE%BE%E8%AE%A1/" data-id="ckwev4ypq00djros1ag7c1s5d" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/06/30/2018/2018-06-30-Apollo-2-%E5%A6%82%E4%BD%95%E6%94%AF%E6%8C%81-@Value-%E6%B3%A8%E8%A7%A3%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">新</strong>
      <div class="article-nav-title">
        
          Apollo-2-如何支持-@Value-注解自动更新
        
      </div>
    </a>
  
  
    <a href="/2018/06/30/2018/2018-06-30-Apollo-4-%E5%AE%A2%E6%88%B7%E7%AB%AF-SDK-%E8%AE%BE%E8%AE%A1/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">旧</strong>
      <div class="article-nav-title">Apollo-4-客户端-SDK-设计</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">文章分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Apollo/">Apollo</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JVM/">JVM</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java-%E4%B8%AD%E9%97%B4%E4%BB%B6/">Java 中间件</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">Java 性能优化</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java-%E8%AE%BE%E8%AE%A1/">Java 设计</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Message-Queue/">Message Queue</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mybatis/">Mybatis</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Netty/">Netty</a><span class="category-list-count">19</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SOFA/">SOFA</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tomcat/">Tomcat</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/my-open-source/">my open source</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/zuul/">zuul</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E4%BA%AB%E6%96%87%E7%AB%A0/">分享文章</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80/">基础</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E4%BD%9C%E6%95%88%E7%8E%87/">工作效率</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">并发编程</a><span class="category-list-count">50</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%89%AF%E6%B7%A1/">扯淡</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5/">故障排查</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><span class="category-list-count">10</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">文章归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a><span class="archive-list-count">22</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">25</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">25</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">27</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">20</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 莫那·鲁道<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">莫那·鲁道</a>
  
    <a href="/archives" class="mobile-nav-link">文章归档</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>